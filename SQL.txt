1. Initial mapreduce job:

SELECT payment, SUM(sales)
FROM minipurchases
GROUP BY payment;

2. Change the mapper so that you calculate the sum for each category (not payment type):

SELECT category, SUM(sales) 
FROM minipurchases 
GROUP BY category;

3. Change the reducer so that you calculate the total number (count) of purchases for each category (not the sum of the sales)

SELECT category, COUNT(*) 
FROM purchases 
GROUP BY category;

4. Change the mapper so that an error is raised when there are not six elements in the tuple

# This SQL command checks that all 6 fields are present in the processes records.

SELECT payment, sales
FROM minipurchases
WHERE Date IS NOT NULL AND Time IS NOT NULL AND Item IS NOT NULL AND Category IS NOT NULL AND Sales IS NOT NULL AND Payment IS NOT NULL;

5. Change the mapper so that you calculate the sum only for the categories "Computers", "Cameras" and "Video Games"

SELECT category, SUM(sales) 
FROM minipurchases 
WHERE category IN ('Computers', 'Cameras', 'Video Games') 
GROUP BY category;

6. Change the reducer, so that only categories are shown, that have a total number (count) of more than 114 purchases

SELECT category, COUNT(*) 
FROM purchases 
GROUP BY category 
HAVING COUNT(*) > 114;
